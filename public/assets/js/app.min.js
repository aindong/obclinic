!function(e,t,n){"use strict";toastr.options={closeButton:!0,debug:!1,positionClass:"toast-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},e("#main-menu > li").click(function(){e(this).addClass("active").siblings().removeClass("active")}),e("#main-menu li ul li").click(function(){var t=e(this).parent().parent();t.hasClass("active")||t.addClass("active").siblings().removeClass("active")}),window.App={Helpers:{},Models:{},Views:{Maintenance:{}},Collections:{}}}(jQuery,Backbone,Marionette),App.Helpers.Http=function(e){"use strict";var t={};return t.getTemplate=function(e){},t.post=function(t,n,a,i){var s=t,r=n,o=e(".btn-loading-state");return e.ajax({url:a,type:"POST",data:r.serialize(),beforeSend:function(){o.button("loading")},success:function(e){"success"==e.status?(toastr.success(i.success,"Success"),s.triggerMethod("render")):toastr.error(i.failed,"Error")},error:function(){toastr.error(i.failed,"Error")},complete:function(){o.button("reset")}}),this},t}(jQuery),App.Helpers.Images=function(e){"use strict";function t(e,t,n){var a=document.createElement("canvas"),i=a.getContext("2d"),s=new Image;s.crossOrigin="Anonymous",s.onload=function(){a.height=s.height,a.width=s.width,i.drawImage(s,0,0);var e=a.toDataURL(n||"image/png");t.call(this,e),a=null},s.source=e}return{ImgToBase64:t}}(window.App),App.Helpers.Loader=function(){var e={};return e.show=function(){$("#loader").show()},e.hide=function(){$("#loader").hide()},e}(),App.Helpers.Table=function(e){"use strict";var t,n=function(){},a=n.prototype;return a.initialize=function(e,t){this._initDataTables(e,t)},a._initDataTables=function(e,t){$.isFunction($.fn.dataTable)&&this._createDataTable(e,t)},a._createDataTable=function(e,n){$.fn.dataTable.isDataTable(e)?(t=e.DataTable(),t.ajax.reload()):t=e.DataTable({dom:'T<"clear">lfrtip',ajax:e.data("source"),columns:n,tableTools:{sSwfPath:e.data("swftools")},order:[[1,"asc"]],language:{lengthMenu:"_MENU_ entries per page",search:'<i class="fa fa-search"></i>',paginate:{previous:'<i class="fa fa-angle-left"></i>',next:'<i class="fa fa-angle-right"></i>'}}})},a._formatDetails=function(e){return'<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;"><tr><td>Full name:</td><td>'+e.name+"</td></tr><tr><td>Extension number:</td><td>"+e.extn+"</td></tr><tr><td>Extra info:</td><td>And any further details here (images etc)...</td></tr></table>"},a}(window.App),App.Models.Allergy=function(e){"use strict";var t=Backbone.Model.extend({"default":{type:"",name:""}});return t}(window.App),App.Models.Patient=function(e){"use strict";var t=Backbone.Model.extend({defaults:{patient_no:"",firstname:"Ann",lastname:"Laurens",middlename:"M",address:"795 Folsom Ave, San Francisco, CA 94107",birthdate:"",contactno:"567-890-1234",email:"ann@laurens.com",picture:"avatar9463a.jpg"}});return t}(window.App),App.Models.Queue=function(e){"use strict";var t=Backbone.Model.extend({"default":{id:"",arrival:"",patient_no:"",vitalsign_id:"",reservation_type:""}});return t}(window.App),App.Collections.Patients=function(e){"use strict";var t=Backbone.Collection.extend({model:e.Models.PatientModel,url:"/api/v1/patients",parse:function(e){return e.data}});return t}(window.App),App.Views.Appointments=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/appointments/index.tpl.html",function(t){var n=Handlebars.compile(t);$.get("/api/v1/patients?q=all",function(t){e.$el.html(n({data:t})),e.triggerMethod("render"),$("select").select2();var a=document.querySelector("#appointmentForm");return a.addEventListener("submit",_.bind(e.createAppointment,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"patient_no"},{data:"name"},{data:"appointment_date"},{data:"status"},{data:"created_by"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createAppointment:function(t){t.preventDefault();var n=$("#appointmentForm"),a="/api/v1/appointments",i={success:"Successfully created a new appointment",failed:"Failed to add a new appointment"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),App.Views.Patients=function(e){"use strict";var t=Marionette.View.extend({el:"#createForm",events:{submit:"createPatient"},createPatient:function(e){e.preventDefault();var t=this.collection.create({patient_no:this.$("#patient_no").val(),firstname:this.$("#firstname").val(),lastname:this.$("#lastname").val(),middlename:this.$("#middlename").val(),address:this.$("#address").val(),birthdate:this.$("#birthdate").val(),contactno:this.$("#contactno").val(),email:this.$("#email").val()},{wait:!0});console.log(t)}});return{Create:t}}(window.App),App.Views.Patients=function(e){"use strict";var t=new e.Collections.Patients,n=Marionette.View.extend({el:$(".section-body"),initialize:function(){this.collection.on("sync",this.render,this);new e.Views.Patients.Create({collection:t})},collection:t,render:function(){var e=Handlebars.compile($("#patient-place").html()),t=e({patients:this.collection.toJSON()});return this.$el.html(t),this},onBeforeRender:function(){var e=this;this.collection.fetch().then(function(){e.render(),e.triggerMethod("render")})},onRender:function(){console.log("rendered")}});return{List:n}}(window.App),App.Views.Queues=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/queues/index.tpl.html",function(t){var n=Handlebars.compile(t);$.get("/api/v1/patients?q=all",function(t){e.$el.html(n({data:t})),e.triggerMethod("render"),$("select").select2();var a=document.querySelector("#createQueueForm");return a.addEventListener("submit",_.bind(e.createQueue,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"queue_no"},{data:"arrival"},{data:"patient_id"},{data:"patient_name"},{data:"vitalsign"},{data:"type"}];e.Helpers.Table.initialize($("#datatable2"),t)},createQueue:function(t){t.preventDefault();var n=$("#createQueueForm"),a="/api/v1/queues",i={success:"Successfully added a new patient on the queue",faled:"Failed to add a new patient on the queue"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),App.Views.Maintenance.Allergies=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/allergies/index.tpl.html",function(t){var n=Handlebars.compile(t);e.$el.html(n),e.triggerMethod("render"),$("select").select2();var a=document.querySelector("#allergiesForm");return a.addEventListener("submit",_.bind(e.createAllergy,e)),e})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"type"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createAllergy:function(t){t.preventDefault();var n=$("#allergiesForm"),a="/api/v1/maintenance/allergies",i={success:"Successfully created a new allergy",failed:"Failed to add a new allergy"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),App.Views.Maintenance.Diseases=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/diseases/index.tpl.html",function(t){var n=Handlebars.compile(t);e.$el.html(n),e.triggerMethod("render");var a=document.querySelector("#diseasesForm");return a.addEventListener("submit",_.bind(e.createDisease,e)),e})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createDisease:function(t){t.preventDefault();var n=$("#diseasesForm"),a="/api/v1/maintenance/diseases",i={success:"Successfully added a disease",failed:"Failed to add a new disease"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),App.Views.Maintenance.Medicines=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/medicines/index.tpl.html",function(t){var n=Handlebars.compile(t);e.$el.html(n),e.triggerMethod("render");var a=document.querySelector("#medicinesForm");return a.addEventListener("submit",_.bind(e.createMedicine,e)),e})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createMedicine:function(t){t.preventDefault();var n=$("#medicinesForm"),a="/api/v1/maintenance/medicines",i={success:"Successfully created a new medicine",failed:"Failed to create a new medicine"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),App.Views.Maintenance.Users=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/users/users.tpl.html",function(t){var n=Handlebars.compile(t);$.get("/api/v1/maintenance/users/roles",function(t){e.$el.html(n({data:t})),e.triggerMethod("render"),$("select").select2();var a=document.querySelector("#usersForm");return a.addEventListener("submit",_.bind(e.createUser,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"username"},{data:"name"},{data:"role"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#usersTable"),t)},createUser:function(t){t.preventDefault();var n=$("#usersForm"),a="/api/v1/maintenance/users",i={success:"Successfully created a new user",failed:"Failed to create a new user"},s=e.Helpers.Http;s.post(this,n,a,i)}});return{List:t}}(window.App),function(e){"use strict";var t=Backbone.Router.extend({routes:{"":"index","maintenance/users":"showUsers",appointments:"showAppointments",patients:"showPatients","maintenance/allergies":"showAllergies","maintenance/diseases":"showDiseases","maintenance/medicines":"showMedicines","*action":"showQueues"},initialize:function(){Backbone.history.start({pushState:!1})},index:function(){var t=new e.Views.Queues.List;t.render()},showUsers:function(){var t=new e.Views.Maintenance.Users.List;t.render()},showAppointments:function(){var t=new e.Views.Appointments.List;t.render()},showPatients:function(){var t=new e.Views.Patients.List;t.triggerMethod("before:render")},showAllergies:function(){var t=new e.Views.Maintenance.Allergies.List;t.render()},showDiseases:function(){var t=new e.Views.Maintenance.Diseases.List;t.render()},showMedicines:function(){var t=new e.Views.Maintenance.Medicines.List;t.render()}});return new t}(window.App);