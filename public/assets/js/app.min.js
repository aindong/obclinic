!function(e,t,a){"use strict";toastr.options={closeButton:!0,debug:!1,positionClass:"toast-bottom-right",onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},window.App={Helpers:{},Models:{},Views:{Maintenance:{}},Collections:{}}}(jQuery,Backbone,Marionette),App.Helpers.Images=function(e){"use strict";function t(e,t,a){var n=document.createElement("canvas"),r=n.getContext("2d"),i=new Image;i.crossOrigin="Anonymous",i.onload=function(){n.height=i.height,n.width=i.width,r.drawImage(i,0,0);var e=n.toDataURL(a||"image/png");t.call(this,e),n=null},i.source=e}return{ImgToBase64:t}}(window.App),App.Helpers.Table=function(e){"use strict";var t=function(){},a=t.prototype;return a.initialize=function(e,t){this._initDataTables(e,t)},a._initDataTables=function(e,t){$.isFunction($.fn.dataTable)&&this._createDataTable(e,t)},a._createDataTable=function(e,t){e.DataTable({dom:'T<"clear">lfrtip',ajax:e.data("source"),columns:t,tableTools:{sSwfPath:e.data("swftools")},order:[[1,"asc"]],language:{lengthMenu:"_MENU_ entries per page",search:'<i class="fa fa-search"></i>',paginate:{previous:'<i class="fa fa-angle-left"></i>',next:'<i class="fa fa-angle-right"></i>'}}})},a._formatDetails=function(e){return'<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;"><tr><td>Full name:</td><td>'+e.name+"</td></tr><tr><td>Extension number:</td><td>"+e.extn+"</td></tr><tr><td>Extra info:</td><td>And any further details here (images etc)...</td></tr></table>"},a}(window.App),App.Models.Allergy=function(e){"use strict";var t=Backbone.Model.extend({"default":{type:"",name:""}});return t}(window.App),App.Models.Patient=function(e){"use strict";var t=Backbone.Model.extend({defaults:{patient_no:"",firstname:"Ann",lastname:"Laurens",middlename:"M",address:"795 Folsom Ave, San Francisco, CA 94107",birthdate:"",contactno:"567-890-1234",email:"ann@laurens.com",picture:"avatar9463a.jpg"}});return t}(window.App),App.Models.Queue=function(e){"use strict";var t=Backbone.Model.extend({"default":{id:"",arrival:"",patient_no:"",vitalsign_id:"",reservation_type:""}});return t}(window.App),App.Collections.Patients=function(e){"use strict";var t=Backbone.Collection.extend({model:e.Models.PatientModel,url:"/api/v1/patients",parse:function(e){return e.data}});return t}(window.App),App.Views.Appointments=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/appointments/index.tpl.html",function(t){var a=Handlebars.compile(t);$.get("/api/v1/patients?q=all",function(t){e.$el.html(a({data:t})),e.triggerMethod("render"),$("select").select2();var n=document.querySelector("#appointmentForm");return n.addEventListener("submit",_.bind(e.createAppointment,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"patient_no"},{data:"name"},{data:"appointment_date"},{data:"status"},{data:"created_by"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createAppointment:function(e){var t=this,a=$("#appointmentForm");e.preventDefault(),$.ajax({url:"/api/v1/appointments",type:"POST",data:a.serialize(),success:function(e){"success"==e.status?(toastr.success("Successfully created a new appointment","Success"),t.render(),t.triggerMethod("render")):toastr.error("Failed to add a new appointment","Error")},error:function(){toastr.error("Failed to add a new appointment","Error")}})}});return{List:t}}(window.App),App.Views.Patients=function(e){"use strict";var t=Marionette.View.extend({el:"#createForm",events:{submit:"createPatient"},createPatient:function(e){e.preventDefault();var t=this.collection.create({patient_no:this.$("#patient_no").val(),firstname:this.$("#firstname").val(),lastname:this.$("#lastname").val(),middlename:this.$("#middlename").val(),address:this.$("#address").val(),birthdate:this.$("#birthdate").val(),contactno:this.$("#contactno").val(),email:this.$("#email").val()},{wait:!0});console.log(t)}});return{Create:t}}(window.App),App.Views.Patients=function(e){"use strict";var t=new e.Collections.Patients,a=Marionette.View.extend({el:$(".section-body"),initialize:function(){this.collection.on("sync",this.render,this);new e.Views.Patients.Create({collection:t})},collection:t,render:function(){var e=Handlebars.compile($("#patient-place").html()),t=e({patients:this.collection.toJSON()});return this.$el.html(t),this},onBeforeRender:function(){var e=this;this.collection.fetch().then(function(){e.render(),e.triggerMethod("render")})},onRender:function(){console.log("rendered")}});return{List:a}}(window.App),App.Views.Queues=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/queues/index.tpl.html",function(t){var a=Handlebars.compile(t);$.get("/api/v1/patients?q=all",function(t){e.$el.html(a({data:t})),e.triggerMethod("render"),$("select").select2();var n=document.querySelector("#createQueueForm");return n.addEventListener("submit",_.bind(e.createQueue,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"queue_no"},{data:"arrival"},{data:"patient_id"},{data:"patient_name"},{data:"vitalsign"},{data:"type"}];e.Helpers.Table.initialize($("#datatable2"),t)},createQueue:function(e){e.preventDefault();var t=this,a=$("#createQueueForm");$.ajax({url:"/api/v1/queues",type:"POST",data:a.serialize(),success:function(e){console.log(e),"success"==e.status?(toastr.success("Successfully added a new queue","Success"),t.render(),t.triggerMethod("render")):toastr.error("Opps! Theres something wrong","Error")},error:function(e,t,a){toastr.error("Opps! Theres something wrong","Error")}})}});return{List:t}}(window.App),App.Views.Maintenance.Allergies=function(e){"use strict";var t=Marionette.View.extend({el:$(".section-body"),initialize:function(){var e=document.querySelector("#allergiesForm");e.addEventListener("submit",_.bind(this.createAllergy,this))},render:function(){var e=_.template($("#allergy-table").html(),{});return this.$el.html(e),this},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"type"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createAllergy:function(e){var t=this,a=$("#allergiesForm");e.preventDefault(),$.ajax({url:"/api/v1/maintenance/allergies",type:"POST",data:a.serialize(),success:function(e){"success"==e.status?(toastr.success("Successfully created a new allergy","Success"),t.render(),t.triggerMethod("render")):toastr.error("Failed to add a new allergy","Error")},error:function(){toastr.error("Failed to add a new allergy","Error")}})}});return{List:t}}(window.App),App.Views.Maintenance.Diseases=function(e){"use strict";var t=Marionette.View.extend({el:$(".section-body"),initialize:function(){var e=document.querySelector("#diseasesForm");e.addEventListener("submit",_.bind(this.createDisease,this))},render:function(){var e=_.template($("#disease-table").html(),{});return this.$el.html(e),this},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createDisease:function(e){e.preventDefault();var t=this,a=$("#diseasesForm");$.ajax({url:"/api/v1/maintenance/diseases",type:"POST",data:a.serialize(),success:function(e){"success"==e.status?(toastr.success("Successfully added a disease","Success"),t.render(),t.triggerMethod("render")):toastr.error("Failed to add a new disease","Error")},error:function(){toastr.error("Failed to add a new disease","Error")}})}});return{List:t}}(window.App),App.Views.Maintenance.Medicines=function(e){"use strict";var t=Marionette.View.extend({el:$(".section-body"),initialize:function(){var e=document.querySelector("#medicinesForm");e.addEventListener("submit",_.bind(this.createMedicine,this))},render:function(){var e=_.template($("#medicine-table").html(),{});return this.$el.html(e),this},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"id"},{data:"name"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#datatable2"),t)},createMedicine:function(e){e.preventDefault();var t=$("#medicinesForm"),a=this;$.ajax({url:"/api/v1/maintenance/medicines",type:"POST",data:t.serialize(),success:function(e){"success"==e.status?(toastr.success("Successfully created a new medicine","Success"),a.render(),a.triggerMethod("render")):toastr.error("Failed to create a new medicine","Error")},error:function(){toastr.error("Failed to create a new medicine","Error")}})}});return{List:t}}(window.App),App.Views.Maintenance.Users=function(e){"use strict";var t=Marionette.View.extend({el:$("#content"),initialize:function(){},render:function(){var e=this;$.get("/assets/templates/users/users.tpl.html",function(t){var a=Handlebars.compile(t);$.get("/api/v1/maintenance/users/roles",function(t){e.$el.html(a({data:t})),e.triggerMethod("render"),$("select").select2();var n=document.querySelector("#usersForm");return n.addEventListener("submit",_.bind(e.createUser,e)),e})})},onRender:function(){var t=[{"class":"details-control",orderable:!1,data:null,defaultContent:""},{data:"username"},{data:"name"},{data:"role"},{data:"created"},{data:"updated"},{data:"actions"}];e.Helpers.Table.initialize($("#usersTable"),t)},createUser:function(e){var t=this,a=$("#usersForm");e.preventDefault(),$.ajax({url:"/api/v1/maintenance/users",type:"POST",data:a.serialize(),success:function(e){"success"==e.status?(toastr.success("Successfully created a new user","Success"),t.render(),t.triggerMethod("render")):toastr.error("Failed to add a new user","Error")},error:function(){toastr.error("Failed to add a new user","Error")}})}});return{List:t}}(window.App),function(e){"use strict";var t=Backbone.Router.extend({routes:{"":"index","maintenance/users":"showUsers",appointments:"showAppointments",patients:"showPatients","maintenance/allergies":"showAllergies","maintenance/diseases":"showDiseases","maintenance/medicines":"showMedicines","*action":"showQueues"},initialize:function(){Backbone.history.start({pushState:!1})},index:function(){var t=new e.Views.Queues.List;t.render()},showUsers:function(){var t=new e.Views.Maintenance.Users.List;t.render()},showAppointments:function(){var t=new e.Views.Appointments.List;t.render()},showPatients:function(){var t=new e.Views.Patients.List;t.triggerMethod("before:render")},showAllergies:function(){var t=new e.Views.Maintenance.Allergies.List;t.render()},showDiseases:function(){var t=new e.Views.Maintenance.Diseases.List;t.render()},showMedicines:function(){var t=new e.Views.Maintenance.Medicines.List;t.render()}});return new t}(window.App);